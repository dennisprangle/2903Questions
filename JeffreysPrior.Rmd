---
output: html_document
---
```{r data generation, echo = FALSE, results = "hide"}
d<-sample(c('e','bi','g'),1)

dis<-if(d=='e'){
  print("an exponential")
} else if (d=='bi'){
  print("a binomial")
} else if (d=='g'){
  print("a gamma")
}

dis2<-if(d=='e'){
  print("Exp(\\theta)")
} else if(d=='bi'){
  print("Bin(k,\\theta)")
} else if(d=='g'){
  print("Ga(\\alpha,\\theta)")
}

li<-if(d=='e'){
  print("f(\\underline{x}|\\theta)=\\theta^n\\exp(-\\theta n\\bar{x})")
} else if(d=='bi'){
  print("f(\\underline{x}|k,\\theta)=\\left[\\overset{n}{\\underset{i=1}{\\prod}} {{k}\\choose{x_i}}\\right] \\theta^{n\\bar{x}}\\theta^{n(k-\\bar{x})}")
} else if(d=='g'){
  print("f(\\underline{x}|\\theta)=\\overset{n}{\\underset{i=1}{\\prod}}\\frac{\\theta^{\\alpha}X_i^{\\alpha-1}e^{-X_{i}\\theta}}{\\Gamma(\\alpha)}")
}

lo<-if(d=='e'){
  print("L(\\theta)=n\\log(\\theta)-\\theta n\\bar{x}")
} else if(d=='bi'){
  print("L(\\theta)=\\log\\left(\\left[\\overset{n}{\\underset{i=1}{\\prod}} {{k}\\choose{x_i}}\\right]\\right)+n\\bar{x}\\log(\\theta)+n(k-\\bar{x})\\log(1-\\theta)")
} else if(d=='g'){
  print("L(\\theta)=\\alpha\\log(\\theta)+(\\alpha-1)\\sum\\log(X_i)-\\theta\\sum X_i-n\\log(\\Gamma(\\alpha))")
}

dif<-if(d=='e'){
  print("$$\\begin{aligned}
        \\frac{dL}{d\\theta}&=\\frac{n}{\\theta}-n\\bar{x} \\nonumber \\\\
        \\frac{d^2L}{d\\theta^2}&=-\\frac{n}{\\theta^2} \\nonumber \\\\
        I(\\theta)&=E_{\\bar{X}|\\theta}\\left[-\\frac{d^2L}{d\\theta^2}\\right] \\nonumber \\\\
        &= \\frac{n}{\\theta^2} \\nonumber
        \\end{aligned}$$")
} else if(d=='bi'){
  print("$$\\begin{aligned}
        \\frac{dL}{d\\theta}&=\\frac{n\\bar{x}}{\\theta}-\\frac{n(k-\\bar{x})}{1-\\theta} \\nonumber \\\\
        \\frac{d^2L}{d\\theta^2}&=-\\frac{n\\bar{x}}{\\theta^2}-\\frac{n(k-\\bar{x})}{(1-\\theta)^2} \\nonumber \\\\
        I(\\theta)&=E_{\\bar{X}|\\theta}\\left[-\\frac{d^2L}{d\\theta^2}\\right] \\nonumber \\\\
        &=\\frac{nE[\\bar{X}|\\theta]}{\\theta^2}+\\frac{n(k-E[\\bar{X}|\\theta])}{(1-\\theta)^2} \\nonumber \\\\
        &=\\frac{nk\\theta}{\\theta^2}+\\frac{nk(1-\\theta)}{(1-\\theta)^2} \\nonumber \\\\
        &=\\frac{nk}{\\theta(1-\\theta)} \\nonumber
        \\end{aligned}$$")
} else if(d=='g'){
  print("$$\\begin{aligned}
        \\frac{dL}{d\\theta}&=\\frac{\\alpha}{\\theta}-\\sum X_i \\nonumber \\\\
        \\frac{d^2L}{d\\theta^2}&=-\\frac{\\alpha}{\\theta^2} \\nonumber \\\\
        I(\\theta)&=E_{\\bar{X}|\\theta}\\left[-\\frac{d^2L}{d\\theta^2}\\right] \\nonumber \\\\
        &= \\frac{\\alpha}{\\theta^2} \\nonumber
        \\end{aligned}$$")
}

jp<-if(d=='e'){
  print("$$\\begin{aligned}
        \\pi(\\theta)&\\propto I(\\theta)^{\\frac{1}{2}} \\nonumber \\\\
        &\\propto \\frac{\\sqrt{n}}{\\theta} \\nonumber \\\\
        &\\propto \\frac{1}{\\theta}, \\text{\\vspace{1cm} for $\\theta$ > 0}. \\nonumber
        \\end{aligned}$$")
} else if (d=='bi'){
  print("$$\\begin{aligned}
        \\pi(\\theta)&\\propto I(\\theta)^{\\frac{1}{2}} \\nonumber \\\\
        &\\propto \\frac{\\sqrt{nk}}{\\theta^{\\frac{1}{2}}(1-\\theta)^{\\frac{1}{2}}} \\nonumber \\\\
        &\\propto \\theta^{-\\frac{1}{2}}(1-\\theta)^{-\\frac{1}{2}} \\nonumber
        \\end{aligned}$$")
} else if(d=='g'){
  print("$$\\begin{aligned}
        \\pi(\\theta)&\\propto I(\\theta)^{\\frac{1}{2}} \\nonumber \\\\
        &\\propto \\frac{\\sqrt{\\alpha}}{\\theta} \\nonumber \\\\
        &\\propto \\frac{1}{\\theta} \\nonumber
        \\end{aligned}$$")
}
```

Question
========
Suppose we have a random sample from `r dis` distribution, that is, $X_i|\theta \sim `r dis2`$. Determine the Jeffreys prior for this model.

Solution
========
Recall that the likelihood function for this distribution is $$`r li`.$$

Firstly, we must determine the loglikelihood function: $$`r lo`.$$

We then differentiate this twice to find Fisher's information, $I(\theta)$, which is: `r dif`

Finally, the Jeffreys Prior is `r jp`

Meta-information
================
extype: num
exsolution: 1
exname: jeffreys prior
extol: 0.01