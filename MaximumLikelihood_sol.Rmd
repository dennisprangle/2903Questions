---
output: html_document
---

```{r data generation, echo = FALSE, results = "hide"}
ev <- sample(c('m','i','b'),1)
e <- if (ev=='m'){
  print("the failure times of machine parts at a factory (in years)")
  } else if (ev=='i'){
    print("the IQ of MAS2903 students")
  } else if (ev=='b'){
print("the time between cars passing on a busy road (in seconds)")
  }

di <- if (ev=='m'){
  print("Gamma")
} else if (ev=='i'){
  print("Normal")
} else if (ev=='b'){
  print("Exponential")
}

p<- if(ev=='i'){
  print("")
} else {
  print("up to proportionality")
}

c<- if(ev=='m'){
  print("$\\lambda$")
} else if(ev=='i'){
  print("$\\sigma^2$")
} else if(ev=='b'){
  print("$\\theta$")
}

a=sample(c(4:7),1)
mu=sample(c(120:140),1)

dis <- if(ev=='m'){
  paste("Ga(",a,",$\\lambda$)")
} else if (ev=='i'){
  paste("N(",mu,",$\\sigma^2$)")
} else if (ev=='b'){
  paste("$Exp(\\theta)$")
}
data <- if(ev=='m'){
  round(sample(seq(2,13,length=1000),6),2)
} else if (ev=='i'){
  round(sample(c(100:150),6),2)
} else if (ev=='b'){
  round(sample(seq(0,3,length=1000),6),2)
}

sol1 <- if (ev=='m'){
  paste("$f(\\underline{x}|\\lambda)=\\prod_{i=1}^6\\frac{\\lambda^{",a,"}x_i^{\\alpha-1}e^{-\\lambda x_i}}{\\Gamma(\\alpha)\\lambda^{\\alpha}}\\propto\\prod_{i=1}^6\\lambda^{",a,"}x_i^{\\alpha-1}e^{-\\lambda x_i}=\\prod_{i=1}^6\\lambda^{",a,"}x_i^{",a-1,"}e^{-\\lambda x_i}\\propto \\lambda^{",a,"}e^{-\\lambda \\bar{x}}=\\lambda^{",a,"}\\exp(-",round(mean(data),2),"\\lambda).$")
} else if (ev=='i'){
  paste("$f(\\underline{x}|\\sigma^2)=\\prod_{i=1}^6\\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\\exp\\left\\{\\frac{-(x_i-",mu,")^2}{2\\sigma^2}\\right\\}=(2\\pi)^{-6/2}\\sigma^{-6}\\exp\\left\\{-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^6(x_i-",mu,")^{2}\\right\\}$")
} else if (ev=='b'){
  paste("$f(\\underline{x}|\\theta)=\\prod_{i=1}^6\\theta e^{-\\theta x_i}=\\theta^6e^{-\\theta\\bar{x}}=\\theta^6e^{-",round(mean(data),2),"\\theta}.$")
}

sol2 <- if (ev=='m'){
  paste("$\\ell(\\underline{x}|\\lambda)=\\log(\\lambda^{",a,"}\\exp(-",round(mean(data),2),"\\lambda))=",a,"\\log \\lambda-",round(mean(data),2),"\\lambda .$")
} else if (ev=='i'){
  paste("$\\ell(\\underline{x}|\\sigma^2)=\\log((2\\pi)^{-6/2}\\sigma^{-6}\\exp\\left\\{-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^6(x_i-",mu,")^{2}\\right\\})= -\\frac{6}{2}\\log(2\\pi)-6\\log(\\sigma)-\\frac{1}{2\\sigma^2}\\left\\{\\sum_{i=1}^6(x_i-",mu,")^{2}\\right\\}$")
} else if (ev=='b'){
  paste("$\\ell(\\underline{x}|\\theta)=\\log(\\theta^6e^{-",round(mean(data),2),"\\theta})=6\\log(\\theta)-6",round(mean(data),2),"\\theta.$")
}

sol3 <- if (ev=='m'){
  paste("$\\frac{d\\ell}{d\\lambda}=\\frac{",a,"}{\\lambda}-",round(mean(data),2),".$ Setting this equal to zero, we can calculate the value of $\\lambda$ that maximises the likelihood as $\\hat{\\lambda}=\\frac{",a,"}{",round(mean(data),2),"}=",round(a/(round(mean(data),2)),2),".$")
} else if (ev=='i'){
  paste("$\\frac{d\\ell}{d\\sigma^2}=\\frac{6}{\\sigma}-\\frac{1}{\\sigma^3}\\sum_{i=1}^6(x_i-",mu,")^{2}.$ Setting this equal to zero, we can calculate the value of $\\sigma^2$ that maximises the likelihood as $\\hat{\\sigma^2}=\\frac{1}{6}\\sum_{i=1}^6(x_i-",mu,")^{2}$")
} else if (ev=='b'){
  paste("$\\frac{d\\ell}{d\\theta}=\\frac{6}{\\theta}-6\\times",round(mean(data),2),".$ Solving for $\\frac{d\\ell}{d\\theta}=0$, we get $\\hat{\\theta}=\\frac{1}{\\bar{x}}=\\frac{1}{",round(mean(data),2),"}.$")
}

sol4 <- if(ev=='m'){
  paste("$\\frac{d^2\\ell}{d\\lambda^2}=\\frac{-",a,"}{\\lambda^2}$. This is always negative as $\\lambda^2$ must always be positive, therefore our answer to part (b) is a maximum.")
} else if (ev=='i'){
  paste("$\\frac{d^2\\ell}{d(\\sigma^2)^2}=\\frac{-6}{\\sigma^2}+\\frac{3}{\\sigma^4}\\sum_{i=1}^6(x_i-",mu,")^{2}$. This is always negative as $\\sigma^2, \\sigma^4$, and $\\sum_{i=1}^6(x_i-",mu,")^{2}$ must always be positive, therefore our answer to part (b) is a maximum.")
} else if (ev=='b'){
  paste("$\\frac{d^2\\ell}{d\\theta^2}=\\frac{-6}{\\theta^2}$. This is always negative as $\\theta^2$ is always positive, therefore our answer to part (b) is a maximum.")
}


```

Solution
========

### Part 1

The likelihood is

`r sol1`

### Part 2

The log-likelihood is

`r sol2`

### Part 3

`r sol3`

### Part 4

`r sol4`
  


